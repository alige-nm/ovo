<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>膀胱训练计划</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      background-color: #d0e8ff; 
      text-align: center; 
      margin: 0; 
      padding: 0; 
    }
    .container { 
      max-width: 900px; 
      margin: auto; 
      padding: 20px; 
    }
    h1 { color: #005baa; }
    .grid { 
      display: grid; 
      grid-template-columns: repeat(5, 1fr); 
      gap: 10px; 
      margin-bottom: 20px;
    }
    .box { 
      display: block; 
      background-color: #69bff8; 
      color: white; 
      text-decoration: none; 
      padding: 15px; 
      border-radius: 8px; 
      font-size: 16px; 
    }
    .box:hover { background-color: #3a91d8; }
    button { 
      padding: 8px 16px; 
      font-size: 14px; 
      margin: 5px; 
      border: none; 
      cursor: pointer; 
      border-radius: 5px; 
    }
    .task-list, #dailyPlanList, #periodic-tasks { 
      text-align: left; 
      margin: 10px auto; 
      max-width: 400px; 
      list-style: none; 
      padding: 0;
    }
    .task-list li, #dailyPlanList li, #periodic-tasks li { 
      margin-bottom: 10px; 
    }
    textarea { 
      width: 80%; 
      max-width: 400px; 
    }
    #calcButtons button { 
      width: 40px; 
      height: 40px; 
      margin: 3px; 
      font-size: 16px;
    }
    /* 新增宠物选择样式 */
    #petAvatar { margin-top: 10px; max-width:150px; }
    /* 哥哥面板 */
    #brotherMessage { margin-top: 10px; font-weight: bold; color: #a00; }
  </style>
</head>
<body>
  <div class="container">
    <h1>膀胱训练计划</h1>
    <div class="grid">
      <a href="#" onclick="showPage('tasks')" class="box">每日任务</a>
      <a href="#" onclick="showPage('dailyPlan')" class="box">每日计划</a>
      <a href="#" onclick="showPage('sticky')" class="box">便签</a>
      <a href="#" onclick="showPage('petCare')" class="box">养宠</a>
      <a href="#" onclick="showPage('calculator')" class="box">计算机</a>
      <a href="#" onclick="showPage('points')" class="box">积分系统</a>
      <a href="#" onclick="showPage('toilet')" class="box">如厕申请</a>
      <a href="#" onclick="showPage('punishments')" class="box">惩罚与奖励</a>
      <a href="#" onclick="showPage('brother')" class="box">哥哥</a>
    </div>

    <!-- 每日任务 -->
    <div id="tasks" style="display:none;">
      <h2>每日任务</h2>
      <ul class="task-list">
        <li><button onclick="completeTask(10)">揉膀胱5分钟 (+10分)</button></li>
        <li><button onclick="completeTask(15)">按压膀胱10次 (+15分)</button></li>
        <li><button onclick="completeTask(20)">多喝500ml水 (+20分)</button></li>
        <li><button onclick="completeTask(-10)">未完成任务 (-10分)</button></li>
        <li><button onclick="completeTask(25)">坐立5分钟不动 (+25分)</button></li>
        <li><button onclick="completeTask(-20)">偷懒一次 (-20分)</button></li>
        <li><button onclick="completeTask(30)">保持尿意30分钟 (+30分)</button></li>
        <li><button onclick="completeTask(35)">上厕所前深蹲20次 (+35分)</button></li>
        <li><button onclick="completeTask(50)">忍尿1小时 (+50分)</button></li>
        <li><button onclick="completeTask(-30)">申请失败一次 (-30分)</button></li>
       <li><button onclick="completeTask(11)"> 揉膀胱6分钟 (+11分)</button></li>
       <li><button onclick="completeTask(17)"> 按压膀胱12次 (+17分)</button></li>
      <li><button onclick="completeTask(23)"> 多喝600ml水 (+23分)</button></li>
      <li><button onclick="completeTask(-11)"> 未完成任务 (-11分)</button></li>
      <li><button onclick="completeTask(27)"> 坐立6分钟不动 (+27分)</button></li>
     <li><button onclick="completeTask(-21)"> 偷懒一次 (-21分)</button></li>
     <li><button onclick="completeTask(33)"> 保持尿意40分钟 (+33分)</button></li>
     <li><button onclick="completeTask(37)"> 上厕所前深蹲18次 (+37分)</button></li>
     <li><button onclick="completeTask(52)"> 忍尿1.2小时 (+52分)</button></li>
     <li><button onclick="completeTask(-32)"> 申请失败一次 (-32分)</button></li>
     <li><button onclick="completeTask(13)"> 按摩膀胱7分钟 (+13分)</button></li>
     <li><button onclick="completeTask(19)"> 压膀胱14次 (+19分)</button></li>
     <li><button onclick="completeTask(21)"> 补充500ml温水 (+21分)</button></li>
     <li><button onclick="completeTask(-13)"> 未完成规定任务 (-13分)</button></li>
     <li><button onclick="completeTask(29)"> 坐立7分钟不动 (+29分)</button></li>
     <li><button onclick="completeTask(-24)"> 偷懒行为一次 (-24分)</button></li>
     <li><button onclick="completeTask(34)"> 持续尿意45分钟 (+34分)</button></li>
     <li><button onclick="completeTask(36)"> 上厕所前做深蹲15次 (+36分)</button></li>
     <li><button onclick="completeTask(48)"> 忍尿90分钟 (+48分)</button></li>
     <li><button onclick="completeTask(-33)"> 申请如厕失败 (-33分)</button></li>
     <li><button onclick="completeTask(14)"> 揉膀胱8分钟 (+14分)</button></li>
     <li><button onclick="completeTask(16)"> 按压膀胱11次 (+16分)</button></li>
     <li><button onclick="completeTask(24)"> 快速喝600ml水 (+24分)</button></li>
     <li><button onclick="completeTask(-14)"> 未完成任务扣分 (-14分)</button></li>
     <li><button onclick="completeTask(30)"> 坐立8分钟不动 (+30分)</button></li>
     <li><button onclick="completeTask(-26)"> 偷懒一次扣分 (-26分)</button></li>
     <li><button onclick="completeTask(38)"> 保持尿意50分钟 (+38分)</button></li>
     <li><button onclick="completeTask(42)"> 上厕所前做深蹲22次 (+42分)</button></li>
     <li><button onclick="completeTask(54)"> 忍尿1.3小时 (+54分)</button></li>
     <li><button onclick="completeTask(-40)"> 申请失败扣分 (-40分)</button></li>
     <li><button onclick="completeTask(15)"> 揉膀胱9分钟 (+15分)</button></li>
     <li><button onclick="completeTask(20)"> 按压膀胱13次 (+20分)</button></li>
     <li><button onclick="completeTask(26)"> 多喝650ml水 (+26分)</button></li>
     <li><button onclick="completeTask(-16)"> 未完成任务扣分 (-16分)</button></li>
     <li><button onclick="completeTask(32)"> 坐立9分钟不动 (+32分)</button></li>
     <li><button onclick="completeTask(-28)"> 偷懒扣分一次 (-28分)</button></li>
     <li><button onclick="completeTask(40)"> 保持尿意55分钟 (+40分)</button></li>
     <li><button onclick="completeTask(44)"> 上厕所前深蹲24次 (+44分)</button></li>
     <li><button onclick="completeTask(56)"> 忍尿1.4小时 (+56分)</button></li>
     <li><button onclick="completeTask(-42)"> 申请失败扣分 (-42分)</button></li>
     <li><button onclick="completeTask(31)"> 按摩膀胱10分钟 (+31分)</button></li>
     <li><button onclick="completeTask(62)"> 保持尿意60分钟 (+62分)</button></li>
     <li><button onclick="completeTask(28)"> 按压膀胱15次 (+28分)</button></li>
     <li><button onclick="completeTask(35)"> 按压膀胱18次 (+35分)</button></li>
     <li><button onclick="completeTask(39)"> 多喝700ml水 (+39分)</button></li>
     <li><button onclick="completeTask(41)"> 坐立7分钟不动 (+41分)</button></li>
     <li><button onclick="completeTask(-30)"> 偷懒一次 (-30分)</button></li>
     <li><button onclick="completeTask(66)"> 保持尿意65分钟 (+66分)</button></li>
     <li><button onclick="completeTask(46)"> 上厕所前深蹲20次 (+46分)</button></li>
     <li><button onclick="completeTask(70)"> 忍尿1.6小时 (+70分)</button></li>
      </ul>
      <h3>新任务</h3>
      <ul id="periodic-tasks"></ul>
    </div>

    <!-- 每日计划 -->
    <div id="dailyPlan" style="display:none;">
      <h2>每日计划</h2>
      <ul id="dailyPlanList">
        <li><input type="checkbox" onchange="updateDailyPlan()"> 吃早餐</li>
        <li><input type="checkbox" onchange="updateDailyPlan()"> 完成作业</li>
        <li><input type="checkbox" onchange="updateDailyPlan()"> 锻炼身体</li>
      </ul>
      <button onclick="viewDailyPlanHistory()">查看历史计划</button>
      <div id="dailyPlanHistoryDisplay"></div>
    </div>

    <!-- 便签 -->
    <div id="sticky" style="display:none;">
      <h2>便签</h2>
      <textarea id="stickyNoteText" rows="4" placeholder="在此输入便签..."></textarea><br>
      <button onclick="saveStickyNote()">保存便签</button>
      <button onclick="viewStickyNoteHistory()">查看历史便签</button>
      <p id="stickyNoteDisplay"></p>
      <div id="stickyNoteHistoryDisplay"></div>
    </div>

    <!-- 养宠 -->
    <div id="petCare" style="display:none;">
      <h2>养宠</h2>
      <!-- 宠物选择 -->
      <label for="petSelect">选择宠物：</label>
      <select id="petSelect" onchange="changePetAvatar()">
        <option value="cat">小猫</option>
        <option value="dog">小狗</option>
        <option value="rabbit">小兔</option>
        <option value="bird">小鸟</option>
      </select>
      <br>
      <img id="petAvatar" src="https://via.placeholder.com/150?text=Cat" alt="宠物形象">
      <p>宠物如厕状态: <span id="petToiletStatus">未完成</span></p>
      <p>宠物睡觉状态: <span id="petSleepStatus">未完成</span></p>
      <p>宠物好感度: <span id="petAffectionDisplay">50</span></p>
      <button onclick="petGoToToilet()">宠物如厕</button>
      <button onclick="petSleep()">宠物睡觉</button>
      <button onclick="petFeeding()">宠物喂食</button>
      <button onclick="petWatering()">宠物喂水</button>
      <button onclick="resetPetStatus()">重置宠物状态</button>
      <button onclick="maybeTriggerExtraPetEvent()">触发宠物事件</button>
      <p id="petEventMessage"></p>
    </div>

    <!-- 计算机 -->
    <div id="calculator" style="display:none;">
      <h2>计算机</h2>
      <input type="text" id="calcDisplay" readonly style="width: 180px; font-size: 18px;"><br>
      <div id="calcButtons">
        <button onclick="appendCalc('7')">7</button>
        <button onclick="appendCalc('8')">8</button>
        <button onclick="appendCalc('9')">9</button>
        <button onclick="appendCalc('/')">/</button><br>
        <button onclick="appendCalc('4')">4</button>
        <button onclick="appendCalc('5')">5</button>
        <button onclick="appendCalc('6')">6</button>
        <button onclick="appendCalc('*')">*</button><br>
        <button onclick="appendCalc('1')">1</button>
        <button onclick="appendCalc('2')">2</button>
        <button onclick="appendCalc('3')">3</button>
        <button onclick="appendCalc('-')">-</button><br>
        <button onclick="appendCalc('0')">0</button>
        <button onclick="appendCalc('.')">.</button>
        <button onclick="calculateResult()">=</button>
        <button onclick="appendCalc('+')">+</button><br>
        <button onclick="clearCalc()">清空</button>
      </div>
    </div>

    <!-- 积分系统 -->
    <div id="points" style="display:none;">
      <h2>积分系统</h2>
      <p>当前积分: <span id="points-value">0</span></p>
    </div>

    <!-- 如厕申请 -->
    <div id="toilet" style="display:none;">
      <h2>如厕申请</h2>
      <p>剩余如厕次数: <span id="toiletCount">3</span></p>
      <button onclick="applyToilet()">申请如厕</button>
      <p id="toiletStatus"></p>
    </div>

    <!-- 惩罚与奖励 -->
    <div id="punishments" style="display:none;">
      <h2>惩罚与奖励</h2>
      <button onclick="randomPunishment()">随机任务</button>
      <p id="punishmentResult"></p>
    </div>

    <!-- 哥哥面板 -->
    <div id="brother" style="display:none;">
      <h2>哥哥的话</h2>
      <button onclick="brotherSpeak()">听哥哥的话</button>
      <p id="brotherMessage"></p>
    </div>
  </div>

  <script>
    // 初始化积分、如厕次数及宠物和历史记录数据
    let points = localStorage.getItem('points') ? parseInt(localStorage.getItem('points')) : 0;
    let toiletCount = localStorage.getItem('toiletCount') ? parseInt(localStorage.getItem('toiletCount')) : 3;
    let petToiletStatus = localStorage.getItem('petToiletStatus') === "true";
    let petSleepStatus = localStorage.getItem('petSleepStatus') === "true";
    let dailyPlanCompleted = localStorage.getItem('dailyPlanCompleted') === "true";
    let stickyNote = localStorage.getItem('stickyNote') || "";
    let petAffection = localStorage.getItem('petAffection') ? parseInt(localStorage.getItem('petAffection')) : 50;
    let dailyPlanHistory = localStorage.getItem('dailyPlanHistory') ? JSON.parse(localStorage.getItem('dailyPlanHistory')) : [];
    let stickyNoteHistory = localStorage.getItem('stickyNoteHistory') ? JSON.parse(localStorage.getItem('stickyNoteHistory')) : [];

    const punishments = [
      "按压膀胱30秒",
      "深蹲50次",
      "跳绳100次",
      "保持尿意15分钟",
      "揉小腹2分钟",
      "站立不动10分钟",
      "连续写小说500字",
      "手撑膀胱不动1分钟",
      "喝300ml水",
      "闭眼冥想5分钟"
    ];

    // 宠物行动冷却状态
    let petReady = true;

    // 哥哥的话
    const brotherMessages = [
  " 别让我失望，小宇！你再不努力，连如厕资格都别想要。",
  " 记住，每一步都得严格执行，宠物和我都不允许你偷懒！",
  " 你这家伙，连宠物都讨厌你，还想轻易如厕？赶快改正！",
  " 看清楚了，每一次惩罚都是为了让你更好地进步。",
  " 哥哥在这里盯着你，别以为可以逃避责任！",
  " 你不配偷懒，任何松懈都将付出代价。",
  " 每一步都要走得艰难点，只有痛苦才能让你进步。",
  " 不要以为我不会发现你的小动作，所有偷懒的行为都不会放过。",
  " 你想让我对你温柔？没可能，只有冷酷才会成就你。",
  " 你以为可以轻松过关？告诉你，这个世界没那么简单。",
  " 记住，你的每一次失败，都是对我耐心的挑战。",
  " 别想着逃避，我的眼睛比你想象的要锐利。",
  " 想要尊重？先拿出点值得让我尊敬的东西。",
  " 你可以逃避一时，但逃不了一辈子。",
  " 你如果再这么轻松，永远也没资格成为强者。",
  " 每一步的训练，不是为了讨好你，而是为了让你更强。",
  " 你还敢抱怨？不自觉的你，永远也不会得到任何宽容。",
  " 一切都靠自己，别再指望任何人给你救赎。",
  " 我说过，只有忍耐和控制，才能带来真正的力量。",
  " 你不想努力吗？那就永远停留在原地，别想着进步。",
  " 你不认真点，连宠物都看不起你，更别提我了。",
  " 你最好记住，哥哥对你的期望并不会因为你懒惰而减少。",
  " 你现在的懈怠，只会让我更加冷酷无情。",
  " 别觉得我对你不好，只是你不够努力，才导致这一切。",
  " 我不会心软，任何失误都将毫不犹豫地惩罚。",
  " 如果你觉得自己能偷懒，那么你早晚会被淘汰。",
  " 我对你没有一点儿耐心，只会看着你犯错，直到你改正。",
  " 不努力，你的世界将被我无情地碾碎。",
  " 你不想做到最好吗？那就不要再出现在我面前。",
  " 哥哥的要求，你永远达不到，除非你全力以赴。",
  " 不想承受惩罚就努力，不然每一步都将如同地狱。",
  " 你再不努力，甚至连简单的任务都会难倒你。",
  " 你根本不明白，放纵只会让自己堕落得更快。",
  " 我对你不会心软，任何不争气的举动都将被严惩。",
  " 你想让我对你好？那就表现出值得我好的一面。",
  " 每一次偷懒，都是在加深我对你的失望。",
  " 你以为自己可以随便懒惰？别做梦了，你永远都达不到标准。",
  " 我没有时间忍受你的懒惰，要么奋斗，要么永远落后。",
  " 你根本不配享受任何放松，只有痛苦才是你应得的。",
  " 你敢不听话，哥哥一定会让你明白后果。",
  " 不要让我失望，再松懈一下，连厕所都不配进了。",
  " 你不配有任何的特权，只有严格执行才是唯一的道路。",
  " 你以为我会放过你的一丝懈怠？从来没有。",
  " 每一次你失败，都是我看你无能的一刻。",
  " 你要是不能完全控制自己，那就永远在原地打转。",
  " 别想着偷懒，任何失误都将在我的眼皮底下被发现。",
  " 你是否已经意识到，自己根本不配要求任何的轻松？",
  " 没有资格感到安慰，只有面对挑战和压力，才能走得更远。",
  " 我不会对你宽容，只有严格要求，才能真正看到你进步。",
  " 如果你不愿付出，连最基本的任务都做不好。",
  " 你能忍得住吗？再放松一下，看看结果。",
  " 记住，我不会对任何偷懒的行为容忍，执行力是唯一的标准。",
  " 你一直在挑战我的耐心，你就等着看我怎么惩罚你。",
  " 你必须通过努力和忍耐，才能有资格进入更高的阶段。",
  " 想得到一切？那就先从自己开始严格要求起。",
  " 你可以试着不听话，但最后吃亏的永远是你自己。",
  " 只有完全掌控自己，才能不被这个世界击倒。",
  " 我对你的宽容，只有在你真的足够努力的时候才会出现。",
  " 每一次你的软弱，都是对我的不尊重，绝不能容忍。",
  " 你现在的每一点松懈，都会让我更冷漠地对待你。",
  " 别以为我会纵容你，只会让你痛苦地意识到自己的失败。",
  " 你最好记住，想要进步，就得踏过一切的懒惰。",
  " 你每一分懈怠，我都会毫不犹豫地惩罚，直到你觉醒！"
];

    // 宠物额外事件（至少10个）
    const petExtraEvents = [
      { description: "你不小心把水碗撞倒了！", affectionChange: -20, punishment: "喝300ml水", penaltyPoints: 0 },
      { description: "宠物发现你偷懒，狠狠地瞪了你一眼！", affectionChange: -10, punishment: "积分减少10分", penaltyPoints: 10 },
      { description: "宠物故意把食物撒了一地！", affectionChange: -15, punishment: "清理5分钟", penaltyPoints: 0 },
      { description: "宠物突然发脾气，推倒了你的杯子！", affectionChange: -25, punishment: "喝500ml水", penaltyPoints: 0 },
      { description: "宠物在房间里乱跑，把你的便签弄丢了！", affectionChange: -5, punishment: "便签记录丢失", penaltyPoints: 0 },
      { description: "宠物趁你不注意偷吃了你的点心！", affectionChange: -10, punishment: "扣除20积分", penaltyPoints: 20 },
      { description: "宠物弄脏了地板，让你清理！", affectionChange: -15, punishment: "清理后扣10积分", penaltyPoints: 10 },
      { description: "宠物看到你糟糕的表现，心情大坏！", affectionChange: -20, punishment: "积分减少50分", penaltyPoints: 50 },
      { description: "宠物把你的作业撕成碎片！", affectionChange: -30, punishment: "你需要重做作业", penaltyPoints: 0 },
      { description: "宠物发出不满的嘶鸣，彻底不信任你！", affectionChange: -40, punishment: "积分扣除100分", penaltyPoints: 100 }
     { description: "宠物猛然跃起，将水碗猛撞翻，水花四溅。", affectionChange: -20, punishment: "写500字小说反思忍耐", penaltyPoints: 10 },
     { description: "宠物疾步冲向桌边，用爪猛拍桌面，物品纷飞。", affectionChange: -15, punishment: "扣除10积分", penaltyPoints: 10 },
     { description: "宠物突然扑向地面，用力踩碎零食包装。", affectionChange: -25, punishment: "罚你站立10分钟", penaltyPoints: 15 },
     { description: "宠物猛地甩动尾巴，撞倒旁边的杯子。", affectionChange: -20, punishment: "写一篇检讨", penaltyPoints: 10 },
     { description: "宠物用前爪猛抓便签，将记录撕得粉碎。", affectionChange: -30, punishment: "扣除20积分", penaltyPoints: 20 },
     { description: "宠物突然扑向你的脚边，用力蹭过裤脚，动作决绝。", affectionChange: -10, punishment: "罚你做20个俯卧撑", penaltyPoints: 5 },
     { description: "宠物猛冲上桌，将水杯撞飞，溅起大片水花。", affectionChange: -25, punishment: "罚你喝一杯冰水", penaltyPoints: 15 },
     { description: "宠物在你周围急速转圈，尾巴不停甩动，表示不耐。", affectionChange: -15, punishment: "扣除15积分", penaltyPoints: 10 },
    { description: "宠物猛跃起来，用力撞击桌角，物品散落一地。", affectionChange: -20, punishment: "罚你写100字检讨", penaltyPoints: 10 },
    { description: "宠物突然跳起，用力撞击桌面，打翻所有物品。", affectionChange: -30, punishment: "扣除30积分", penaltyPoints: 20 },
    { description: "宠物急速跑过，用爪猛拍墙面，留下深深爪痕。", affectionChange: -25, punishment: "罚你写一篇长检讨", penaltyPoints: 15 },
    { description: "宠物迅速冲向垃圾桶，将桶内物品全部甩出。", affectionChange: -20, punishment: "罚你整理房间", penaltyPoints: 15 },
    { description: "宠物猛地钻进你的书堆，弄得书籍杂乱无章。", affectionChange: -30, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物突然跳上桌面，重重踩在文件上，文件散落一地。", affectionChange: -25, punishment: "罚你重排书桌", penaltyPoints: 15 },
    { description: "宠物猛力推倒笔筒，笔散落四处。", affectionChange: -20, punishment: "罚你写一篇短文反思", penaltyPoints: 10 },
    { description: "宠物急速转身，用冷漠眼神扫视后猛然离去。", affectionChange: -35, punishment: "扣除10积分", penaltyPoints: 10 },
    { description: "宠物飞快奔跑，将角落玩具撞得粉碎。", affectionChange: -20, punishment: "罚你做30个深蹲", penaltyPoints: 15 },
    { description: "宠物猛甩尾巴，将桌上水杯猛撞，水洒满地。", affectionChange: -25, punishment: "罚你写200字检讨", penaltyPoints: 15 },
    { description: "宠物扑向地板，用力抓挠，留下明显爪印。", affectionChange: -20, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物快速绕过你，用力蹭过你的腿，冷漠拒绝接近。", affectionChange: -15, punishment: "罚你做10分钟静坐", penaltyPoints: 10 },
    { description: "宠物猛然冲向桌边，撞倒水瓶，水流四溅。", affectionChange: -20, punishment: "罚你写300字反思", penaltyPoints: 15 },
    { description: "宠物急速跑到文件堆前，用爪猛推，文件散乱。", affectionChange: -30, punishment: "扣除25积分", penaltyPoints: 20 },
    { description: "宠物猛地跃起，将书桌上所有物品撞倒。", affectionChange: -25, punishment: "罚你整理书桌30秒", penaltyPoints: 15 },
    { description: "宠物用力甩动尾巴，将你的笔记猛拍散落。", affectionChange: -20, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物迅速冲向沙发，将靠垫撞飞，动作极快。", affectionChange: -15, punishment: "罚你做10个俯卧撑", penaltyPoints: 10 },
    { description: "宠物猛地跳起，用前爪猛推水杯，水花四射。", affectionChange: -25, punishment: "罚你坚持站立5分钟", penaltyPoints: 15 },
    { description: "宠物快速绕行，用尾巴猛烈扫过桌面，将物品打翻。", affectionChange: -20, punishment: "扣除15积分", penaltyPoints: 10 },
    { description: "宠物猛冲至桌角，用力撞击，发出沉闷撞击声。", affectionChange: -30, punishment: "罚你写一篇长文检讨", penaltyPoints: 20 },
    { description: "宠物迅速用爪抓挠桌面，留下长长的划痕。", affectionChange: -25, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物猛地跳起，将旁边的便签从墙上撕下。", affectionChange: -20, punishment: "罚你整理便签记录", penaltyPoints: 10 },
    { description: "宠物急速绕着你跑，用尾巴猛烈甩动将桌上物品击落。", affectionChange: -30, punishment: "扣除25积分", penaltyPoints: 20 },
    { description: "宠物突然从角落窜出，撞翻你的水杯，水洒一地。", affectionChange: -25, punishment: "罚你做20次俯卧撑", penaltyPoints: 15 },
    { description: "宠物猛然跃起，用力撞击窗台，震碎部分装饰。", affectionChange: -20, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物急速冲向你的书本，将书本重重摔在地上。", affectionChange: -30, punishment: "罚你重写一篇日记", penaltyPoints: 20 },
    { description: "宠物用力甩动尾巴，将桌上所有笔乱扫一地。", affectionChange: -25, punishment: "扣除15积分", penaltyPoints: 15 },
    { description: "宠物猛地扑向垃圾桶，将垃圾全都撞出。", affectionChange: -20, punishment: "罚你整理垃圾", penaltyPoints: 10 },
    { description: "宠物迅速冲到桌前，用爪猛推所有文件，文件纷飞。", affectionChange: -30, punishment: "扣除25积分", penaltyPoints: 20 },
    { description: "宠物猛然跃起，将水瓶重重摔下，水洒四溅。", affectionChange: -25, punishment: "罚你写一篇长篇检讨", penaltyPoints: 20 },
    { description: "宠物急速绕行，用尾巴猛甩，将桌上物品全打翻。", affectionChange: -20, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物突然冲向书桌，用力抓挠桌面，留下深深爪痕。", affectionChange: -30, punishment: "罚你做30个深蹲", penaltyPoints: 20 },
    { description: "宠物猛然转身，用尾巴重重抽打文件堆，文件纷纷散落。", affectionChange: -25, punishment: "扣除20积分", penaltyPoints: 15 },
    { description: "宠物用力撞向桌角，发出沉重撞击声，气势逼人。", affectionChange: -20, punishment: "罚你坚持站立10分钟", penaltyPoints: 15 },
    { description: "宠物最后用力一跃，猛撞水瓶，水花飞溅，宣示极度不满。", affectionChange: -40, punishment: "罚你写一篇长篇小说", penaltyPoints: 30 }
    ];

    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById("points-value").innerText = points;
      document.getElementById("toiletCount").innerText = toiletCount;
      document.getElementById("stickyNoteDisplay").innerText = stickyNote ? "便签内容: " + stickyNote : "";
      document.getElementById("petToiletStatus").innerText = petToiletStatus ? "完成" : "未完成";
      document.getElementById("petSleepStatus").innerText = petSleepStatus ? "完成" : "未完成";
      document.getElementById("petAffectionDisplay").innerText = petAffection;
    });

    // 页面切换
    function showPage(pageId) {
      document.querySelectorAll('.container > div').forEach(div => {
        if (div.id) {
          div.style.display = (div.id === pageId) ? "block" : "none";
        }
      });
    }

    // 每日任务功能
    function completeTask(amount) {
      points += amount;
      localStorage.setItem('points', points);
      document.getElementById("points-value").innerText = points;
      alert("任务完成，积分变化: " + amount);
    }

    function addPeriodicTask() {
      const periodicTasks = document.getElementById("periodic-tasks");
      const newTask = document.createElement("li");
      const tasksArray = [
        { desc: "深呼吸5次", points: 5 },
        { desc: "伸展身体", points: 8 },
        { desc: "整理桌面", points: 10 },
        { desc: "喝一杯水", points: 7 }
      ];
      const randomTask = tasksArray[Math.floor(Math.random() * tasksArray.length)];
      newTask.innerHTML = `<button onclick="completeTask(${randomTask.points})">${randomTask.desc} (+${randomTask.points}分)</button>`;
      periodicTasks.appendChild(newTask);
    }
    setInterval(addPeriodicTask, 30000);

    // 每日计划及历史记录
    function updateDailyPlan() {
      const checkboxes = document.querySelectorAll('#dailyPlanList input[type="checkbox"]');
      let allChecked = true;
      checkboxes.forEach(box => { if (!box.checked) { allChecked = false; } });
      dailyPlanCompleted = allChecked;
      localStorage.setItem('dailyPlanCompleted', dailyPlanCompleted);
      if (dailyPlanCompleted) {
        let record = { date: new Date().toLocaleString(), status: "完成" };
        dailyPlanHistory.push(record);
        localStorage.setItem('dailyPlanHistory', JSON.stringify(dailyPlanHistory));
        alert("每日计划已完成！");
      }
    }
    function viewDailyPlanHistory() {
      const display = document.getElementById("dailyPlanHistoryDisplay");
      display.innerHTML = "<h3>历史计划记录:</h3>";
      if (dailyPlanHistory.length === 0) {
        display.innerHTML += "<p>暂无记录</p>";
      } else {
        let list = document.createElement("ul");
        dailyPlanHistory.forEach(record => {
          let li = document.createElement("li");
          li.innerText = record.date + " - " + record.status;
          list.appendChild(li);
        });
        display.appendChild(list);
      }
    }

    // 便签及历史记录
    function saveStickyNote() {
      const text = document.getElementById('stickyNoteText').value.trim();
      if (text === "") {
        alert("请先输入便签内容！");
        return;
      }
      stickyNote = text;
      localStorage.setItem('stickyNote', text);
      let record = { date: new Date().toLocaleString(), note: text };
      stickyNoteHistory.push(record);
      localStorage.setItem('stickyNoteHistory', JSON.stringify(stickyNoteHistory));
      document.getElementById('stickyNoteDisplay').innerText = "便签内容: " + text;
      alert("便签已保存！");
    }
    function viewStickyNoteHistory() {
      const display = document.getElementById("stickyNoteHistoryDisplay");
      display.innerHTML = "<h3>历史便签记录:</h3>";
      if (stickyNoteHistory.length === 0) {
        display.innerHTML += "<p>暂无记录</p>";
      } else {
        let list = document.createElement("ul");
        stickyNoteHistory.forEach(record => {
          let li = document.createElement("li");
          li.innerText = record.date + " - " + record.note;
          list.appendChild(li);
        });
        display.appendChild(list);
      }
    }

    // 修改宠物形象：宠物选择功能
    function changePetAvatar() {
      const petSelect = document.getElementById("petSelect").value;
      const petAvatar = document.getElementById("petAvatar");
      const avatarMap = {
        cat: "https://via.placeholder.com/150?text=Cat",
        dog: "https://via.placeholder.com/150?text=Dog",
        rabbit: "https://via.placeholder.com/150?text=Rabbit",
        bird: "https://via.placeholder.com/150?text=Bird"
      };
      petAvatar.src = avatarMap[petSelect] || avatarMap["cat"];
    }

    // 宠物随机额外事件触发（50%概率）
    function maybeTriggerExtraPetEvent() {
      if (Math.random() < 0.5) {
        const event = petExtraEvents[Math.floor(Math.random() * petExtraEvents.length)];
        petAffection += event.affectionChange;
        if (petAffection < 0) petAffection = 0;
        localStorage.setItem('petAffection', petAffection);
        document.getElementById("petAffectionDisplay").innerText = petAffection;
        // 处理惩罚，如扣积分或提示额外行为
        if (event.penaltyPoints > 0) {
          points = Math.max(points - event.penaltyPoints, 0);
          localStorage.setItem('points', points);
          document.getElementById("points-value").innerText = points;
        }
        alert(event.description + " 惩罚：" + event.punishment);
      }
    }

    // 宠物冷却与随机事件触发
    function resetPetCooldown() {
      petReady = false;
      let cooldown = Math.floor(Math.random() * (30000 - 10000 + 1)) + 10000; // 10~30秒
      setTimeout(() => {
        petReady = true;
        triggerRandomPetEvent();
        maybeTriggerExtraPetEvent();
      }, cooldown);
    }
    function triggerRandomPetEvent() {
      const events = [
        "宠物突然跳起来打翻了水碗！",
        "宠物开始追逐自己的尾巴。",
        "宠物懒洋洋地伸了个懒腰。",
        "宠物发出一声轻鸣，似乎在表达情绪。"
      ];
      let eventMsg = events[Math.floor(Math.random() * events.length)];
      document.getElementById("petEventMessage").innerText = eventMsg;
      setTimeout(() => { document.getElementById("petEventMessage").innerText = ""; }, 5000);
    }

    // 宠物各项功能
    function petGoToToilet() {
      if (!petReady) { alert("宠物正在忙，请稍候！"); return; }
      petToiletStatus = true;
      localStorage.setItem('petToiletStatus', "true");
      document.getElementById("petToiletStatus").innerText = "完成";
      resetPetCooldown();
      alert("宠物已如厕！");
    }
    function petSleep() {
      if (!petReady) { alert("宠物正在忙，请稍候！"); return; }
      petSleepStatus = true;
      localStorage.setItem('petSleepStatus', "true");
      document.getElementById("petSleepStatus").innerText = "完成";
      resetPetCooldown();
      alert("宠物已睡觉！");
    }
    function petFeeding() {
      if (!petReady) { alert("宠物正在忙，请稍候！"); return; }
      petAffection += 10;
      if(petAffection > 100) petAffection = 100;
      localStorage.setItem('petAffection', petAffection);
      document.getElementById("petAffectionDisplay").innerText = petAffection;
      resetPetCooldown();
      alert("宠物已喂食，好感度提升！");
    }
    function petWatering() {
      if (!petReady) { alert("宠物正在忙，请稍候！"); return; }
      petAffection += 5;
      if(petAffection > 100) petAffection = 100;
      localStorage.setItem('petAffection', petAffection);
      document.getElementById("petAffectionDisplay").innerText = petAffection;
      resetPetCooldown();
      alert("宠物已喂水，好感度提升！");
    }
    function resetPetStatus() {
      petToiletStatus = false;
      petSleepStatus = false;
      localStorage.setItem('petToiletStatus', "false");
      localStorage.setItem('petSleepStatus', "false");
      document.getElementById("petToiletStatus").innerText = "未完成";
      document.getElementById("petSleepStatus").innerText = "未完成";
      alert("宠物状态已重置！");
    }

    // 计算机功能
    function appendCalc(value) {
      document.getElementById("calcDisplay").value += value;
    }
    function calculateResult() {
      try {
        const result = eval(document.getElementById("calcDisplay").value);
        document.getElementById("calcDisplay").value = result;
      } catch (e) { alert("计算错误！"); }
    }
    function clearCalc() {
      document.getElementById("calcDisplay").value = "";
    }

    // 如厕申请——检查各项条件及宠物好感度
    function applyToilet() {
      if (points < 50) {
        document.getElementById("toiletStatus").innerText = "积分不足50，无法申请！";
        return;
      }
      if (!stickyNote) {
        document.getElementById("toiletStatus").innerText = "便签未记录，无法如厕！";
        return;
      }
      if (!dailyPlanCompleted) {
        document.getElementById("toiletStatus").innerText = "每日计划未完成，无法如厕！";
        return;
      }
      if (!localStorage.getItem('petToiletStatus') || localStorage.getItem('petToiletStatus') !== "true") {
        document.getElementById("toiletStatus").innerText = "宠物未如厕，无法如厕！";
        return;
      }
      if (!localStorage.getItem('petSleepStatus') || localStorage.getItem('petSleepStatus') !== "true") {
        document.getElementById("toiletStatus").innerText = "宠物未睡觉，无法如厕！";
        return;
      }
      // 根据宠物好感度判断是否允许如厕
      if(petAffection < 30) {
        document.getElementById("toiletStatus").innerText = "宠物好感度过低，不允许你如厕！";
        return;
      } else if (petAffection >= 30 && petAffection <= 70) {
        if(Math.random() > petAffection/100) {
          document.getElementById("toiletStatus").innerText = "宠物情绪不佳，不让你如厕！";
          return;
        }
      }
      points -= 50;
      localStorage.setItem('points', points);
      document.getElementById("points-value").innerText = points;
      if (toiletCount > 0) {
        toiletCount--;
        localStorage.setItem('toiletCount', toiletCount);
        document.getElementById("toiletCount").innerText = toiletCount;
        document.getElementById("toiletStatus").innerText = "如厕申请通过！";
      } else {
        document.getElementById("toiletStatus").innerText = "今日如厕次数已达上限！";
      }
    }

    // 随机惩罚任务
    function randomPunishment() {
      const punishment = punishments[Math.floor(Math.random() * punishments.length)];
      document.getElementById("punishmentResult").innerText = "随机任务: " + punishment;
    }

    // 哥哥说话功能
    function brotherSpeak() {
      const msg = brotherMessages[Math.floor(Math.random() * brotherMessages.length)];
      document.getElementById("brotherMessage").innerText = "哥哥：" + msg;
      alert("哥哥说：" + msg);
    }
  </script>
</body>
</html>
